<!DOCTYPE html>
<html lang="sv">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Svensk Ordklocka — Simulator</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&display=swap');

  /* ============ THEME VARIABLES ============ */
  :root {
    --bg:           #0d0a08;
    --frame-hi:     #1a1512;
    --frame-lo:     #0f0c0a;
    --border:       #2a2018;
    --cell-off:     #1e1814;
    --cell-on:      #ffd78a;
    --glow1:        #ffb84d;
    --glow2:        rgba(255,184,77,0.5);
    --glow3:        rgba(255,150,50,0.2);
    --dot-on:       #ffd78a;
    --dot-glow:     rgba(255,184,77,0.4);
    --ui-dim:       #5a4a3a;
    --ui-mid:       #8a7a6a;
    --ui-accent:    #ffd78a;
    --ui-accent2:   #c8a86e;
    --hover-bg:     rgba(255,215,138,0.05);
    --modal-bg:     rgba(5,3,2,0.88);
    --manual:       #ff6b6b;
    --manual-glow:  rgba(255,68,68,0.5);
  }

  [data-theme="arctic"] {
    --bg:           #080c14;
    --frame-hi:     #0e1520;
    --frame-lo:     #060a10;
    --border:       #1a2540;
    --cell-off:     #141c2a;
    --cell-on:      #b8e0ff;
    --glow1:        #6bb8ef;
    --glow2:        rgba(107,184,239,0.5);
    --glow3:        rgba(80,160,230,0.2);
    --dot-on:       #b8e0ff;
    --dot-glow:     rgba(107,184,239,0.4);
    --ui-dim:       #3a4a6a;
    --ui-mid:       #6a7a9a;
    --ui-accent:    #b8e0ff;
    --ui-accent2:   #7ab0d8;
    --hover-bg:     rgba(107,184,239,0.05);
    --modal-bg:     rgba(4,6,12,0.90);
    --manual:       #ff6b6b;
    --manual-glow:  rgba(255,68,68,0.5);
  }

  [data-theme="matrix"] {
    --bg:           #020a02;
    --frame-hi:     #0a160a;
    --frame-lo:     #040c04;
    --border:       #143014;
    --cell-off:     #0a1a0a;
    --cell-on:      #33ff33;
    --glow1:        #00cc00;
    --glow2:        rgba(0,204,0,0.5);
    --glow3:        rgba(0,180,0,0.2);
    --dot-on:       #33ff33;
    --dot-glow:     rgba(0,204,0,0.4);
    --ui-dim:       #1a4a1a;
    --ui-mid:       #3a8a3a;
    --ui-accent:    #33ff33;
    --ui-accent2:   #22bb22;
    --hover-bg:     rgba(0,204,0,0.05);
    --modal-bg:     rgba(1,5,1,0.92);
    --manual:       #ff6b6b;
    --manual-glow:  rgba(255,68,68,0.5);
  }

  [data-theme="sunset"] {
    --bg:           #10060a;
    --frame-hi:     #1c0e14;
    --frame-lo:     #0c0408;
    --border:       #3a1828;
    --cell-off:     #1e0e16;
    --cell-on:      #ff8a5c;
    --glow1:        #ff6030;
    --glow2:        rgba(255,96,48,0.5);
    --glow3:        rgba(255,70,30,0.2);
    --dot-on:       #ff8a5c;
    --dot-glow:     rgba(255,96,48,0.4);
    --ui-dim:       #6a3a3a;
    --ui-mid:       #9a6a5a;
    --ui-accent:    #ff8a5c;
    --ui-accent2:   #d06a40;
    --hover-bg:     rgba(255,96,48,0.05);
    --modal-bg:     rgba(8,3,4,0.90);
    --manual:       #ffee55;
    --manual-glow:  rgba(255,238,85,0.5);
  }

  [data-theme="minimal"] {
    --bg:           #111111;
    --frame-hi:     #1a1a1a;
    --frame-lo:     #0e0e0e;
    --border:       #2a2a2a;
    --cell-off:     #222222;
    --cell-on:      #ffffff;
    --glow1:        #cccccc;
    --glow2:        rgba(255,255,255,0.35);
    --glow3:        rgba(255,255,255,0.1);
    --dot-on:       #ffffff;
    --dot-glow:     rgba(255,255,255,0.3);
    --ui-dim:       #444444;
    --ui-mid:       #888888;
    --ui-accent:    #ffffff;
    --ui-accent2:   #aaaaaa;
    --hover-bg:     rgba(255,255,255,0.04);
    --modal-bg:     rgba(0,0,0,0.90);
    --manual:       #ff6b6b;
    --manual-glow:  rgba(255,68,68,0.5);
  }

  [data-theme="rosegold"] {
    --bg:           #0e080a;
    --frame-hi:     #1a1214;
    --frame-lo:     #0c0809;
    --border:       #2e1e22;
    --cell-off:     #1c1416;
    --cell-on:      #f0c0a0;
    --glow1:        #d4947a;
    --glow2:        rgba(212,148,122,0.5);
    --glow3:        rgba(200,130,110,0.2);
    --dot-on:       #f0c0a0;
    --dot-glow:     rgba(212,148,122,0.4);
    --ui-dim:       #5a4044;
    --ui-mid:       #8a6a6e;
    --ui-accent:    #f0c0a0;
    --ui-accent2:   #c09080;
    --hover-bg:     rgba(212,148,122,0.05);
    --modal-bg:     rgba(6,3,4,0.90);
    --manual:       #88ddff;
    --manual-glow:  rgba(136,221,255,0.5);
  }

  /* ============ BASE ============ */
  * { margin: 0; padding: 0; box-sizing: border-box; }

  body {
    background: var(--bg);
    color: #fff;
    font-family: 'JetBrains Mono', monospace;
    min-height: 100vh;
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 30px 20px;
    transition: background 0.5s;
  }

  h1 {
    font-size: 1.2rem;
    color: var(--ui-dim);
    letter-spacing: 6px;
    text-transform: uppercase;
    margin-bottom: 24px;
    transition: color 0.5s;
  }

  .clock-frame {
    background: linear-gradient(145deg, var(--frame-hi), var(--frame-lo));
    border: 2px solid var(--border);
    border-radius: 16px;
    padding: 40px;
    box-shadow:
      0 0 80px rgba(0,0,0,0.8),
      inset 0 0 40px rgba(0,0,0,0.5);
    position: relative;
    transition: background 0.5s, border-color 0.5s;
  }

  .corner-dots {
    position: absolute;
    inset: 0;
    pointer-events: none;
  }

  .corner-dot {
    position: absolute;
    width: 10px;
    height: 10px;
    border-radius: 50%;
    background: var(--frame-hi);
    border: 1px solid var(--border);
    transition: all 0.4s ease;
  }

  .corner-dot.active {
    background: var(--dot-on);
    border-color: var(--dot-on);
    box-shadow: 0 0 10px var(--glow1), 0 0 20px var(--dot-glow);
  }

  .corner-dot:nth-child(1) { top: 16px; left: 16px; }
  .corner-dot:nth-child(2) { top: 16px; right: 16px; }
  .corner-dot:nth-child(3) { bottom: 16px; right: 16px; }
  .corner-dot:nth-child(4) { bottom: 16px; left: 16px; }

  .grid {
    display: grid;
    grid-template-columns: repeat(11, 1fr);
    gap: 4px;
    user-select: none;
  }

  .cell {
    width: 64px;
    height: 64px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.8rem;
    font-weight: 700;
    color: var(--cell-off);
    cursor: pointer;
    border-radius: 4px;
    transition: color 0.4s, text-shadow 0.4s;
  }

  .cell.active {
    color: var(--cell-on);
    text-shadow: 0 0 10px var(--glow1), 0 0 25px var(--glow2), 0 0 50px var(--glow3);
  }

  .cell.manual-toggle {
    color: var(--manual) !important;
    text-shadow: 0 0 10px var(--manual), 0 0 25px var(--manual-glow) !important;
  }

  .cell:hover { background: var(--hover-bg); }

  /* ============ CONTROLS ============ */
  .controls {
    margin-top: 28px;
    width: 100%;
    max-width: 760px;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 12px;
  }

  .time-input {
    font-size: 2.4rem;
    font-family: inherit;
    font-weight: 700;
    color: var(--ui-accent);
    background: transparent;
    border: 1px solid transparent;
    border-radius: 4px;
    text-align: center;
    width: 6ch;
    letter-spacing: 2px;
    padding: 2px 4px;
    transition: border-color 0.2s, color 0.5s;
  }

  .time-input:hover { border-color: var(--border); }
  .time-input:focus {
    outline: none;
    border-color: var(--ui-accent);
    background: var(--hover-bg);
  }
  .time-input::-webkit-calendar-picker-indicator { display: none; }

  .time-text {
    font-size: 0.9rem;
    color: var(--ui-mid);
    text-align: center;
    min-height: 1.3em;
    letter-spacing: 1px;
    transition: color 0.5s;
  }

  .slider-row {
    display: flex;
    align-items: center;
    gap: 12px;
    width: 100%;
  }

  .slider-label {
    font-size: 0.7rem;
    color: var(--ui-dim);
    min-width: 36px;
    text-align: center;
  }

  input[type="range"] {
    -webkit-appearance: none;
    appearance: none;
    flex: 1;
    height: 6px;
    background: var(--frame-hi);
    border: 1px solid var(--border);
    border-radius: 3px;
    outline: none;
    transition: background 0.5s, border-color 0.5s;
  }

  input[type="range"]::-webkit-slider-thumb {
    -webkit-appearance: none;
    width: 20px; height: 20px;
    border-radius: 50%;
    background: var(--ui-accent);
    cursor: pointer;
    box-shadow: 0 0 8px var(--glow2);
  }

  input[type="range"]::-moz-range-thumb {
    width: 20px; height: 20px;
    border-radius: 50%;
    background: var(--ui-accent);
    cursor: pointer;
    border: none;
    box-shadow: 0 0 8px var(--glow2);
  }

  .btn-row {
    display: flex;
    gap: 10px;
    margin-top: 4px;
    flex-wrap: wrap;
    justify-content: center;
  }

  button {
    background: var(--frame-hi);
    color: var(--ui-mid);
    border: 1px solid var(--border);
    padding: 7px 18px;
    border-radius: 4px;
    font-family: inherit;
    font-size: 0.75rem;
    cursor: pointer;
    transition: all 0.2s;
    letter-spacing: 1px;
  }

  button:hover {
    background: var(--border);
    color: var(--ui-accent);
  }

  button.active-btn {
    background: var(--border);
    color: var(--ui-accent);
    border-color: var(--ui-accent);
  }

  /* ============ THEME PICKER ============ */
  .theme-row {
    display: flex;
    gap: 8px;
    align-items: center;
    margin-top: 6px;
  }

  .theme-label {
    font-size: 0.65rem;
    color: var(--ui-dim);
    letter-spacing: 1px;
    text-transform: uppercase;
    margin-right: 4px;
  }

  .theme-swatch {
    width: 24px;
    height: 24px;
    border-radius: 50%;
    border: 2px solid transparent;
    cursor: pointer;
    transition: border-color 0.2s, transform 0.2s;
    position: relative;
  }

  .theme-swatch:hover { transform: scale(1.15); }

  .theme-swatch.selected {
    border-color: var(--ui-accent);
    transform: scale(1.15);
  }

  .theme-swatch[data-t="warm"]     { background: #ffd78a; }
  .theme-swatch[data-t="arctic"]   { background: #b8e0ff; }
  .theme-swatch[data-t="matrix"]   { background: #33ff33; }
  .theme-swatch[data-t="sunset"]   { background: #ff8a5c; }
  .theme-swatch[data-t="minimal"]  { background: #ffffff; }
  .theme-swatch[data-t="rosegold"] { background: #f0c0a0; }

  /* ============ DOCS MODAL ============ */
  .modal-overlay {
    display: none;
    position: fixed;
    inset: 0;
    background: var(--modal-bg);
    z-index: 100;
    justify-content: center;
    align-items: flex-start;
    padding: 40px 20px;
    overflow-y: auto;
  }

  .modal-overlay.open { display: flex; }

  .modal {
    background: linear-gradient(160deg, var(--frame-hi), var(--frame-lo));
    border: 1px solid var(--border);
    border-radius: 12px;
    padding: 40px 44px;
    max-width: 720px;
    width: 100%;
    position: relative;
    box-shadow: 0 0 80px rgba(0,0,0,0.9);
  }

  .modal-close {
    position: absolute;
    top: 16px; right: 20px;
    background: none;
    border: none;
    color: var(--ui-dim);
    font-size: 1.4rem;
    cursor: pointer;
    padding: 4px 8px;
    line-height: 1;
    transition: color 0.2s;
  }

  .modal-close:hover { color: var(--ui-accent); }

  .docs h2 {
    color: var(--ui-accent);
    font-size: 1.1rem;
    letter-spacing: 3px;
    text-transform: uppercase;
    margin: 0 0 24px 0;
    padding-bottom: 12px;
    border-bottom: 1px solid var(--border);
  }

  .docs h3 {
    color: var(--ui-accent2);
    font-size: 0.85rem;
    letter-spacing: 2px;
    text-transform: uppercase;
    margin: 28px 0 12px 0;
  }

  .docs p, .docs li {
    color: var(--ui-mid);
    font-size: 0.78rem;
    line-height: 1.8;
  }

  .docs ul { list-style: none; padding-left: 0; }

  .docs ul li::before {
    content: "\203A";
    color: var(--ui-accent);
    margin-right: 8px;
  }

  .docs code {
    background: var(--hover-bg);
    color: var(--ui-accent2);
    padding: 2px 6px;
    border-radius: 3px;
    font-size: 0.75rem;
  }

  .docs table { width: 100%; border-collapse: collapse; margin: 12px 0; }

  .docs th {
    text-align: left;
    color: var(--ui-accent2);
    font-size: 0.7rem;
    letter-spacing: 1px;
    text-transform: uppercase;
    padding: 8px 10px;
    border-bottom: 1px solid var(--border);
  }

  .docs td {
    color: var(--ui-mid);
    font-size: 0.75rem;
    padding: 6px 10px;
    border-bottom: 1px solid var(--frame-hi);
  }

  .docs td:first-child { color: var(--ui-accent); }

  .docs .grid-preview {
    font-size: 0.72rem;
    line-height: 1.9;
    letter-spacing: 3px;
    color: var(--border);
    margin: 12px 0;
    text-align: center;
  }

  .docs .grid-preview .hl { color: var(--ui-accent); }

  .docs .dot-demo { display: flex; gap: 6px; align-items: center; margin: 4px 0; }

  .docs .dot-demo .dot {
    width: 8px; height: 8px;
    border-radius: 50%;
    border: 1px solid var(--border);
    background: var(--frame-hi);
  }

  .docs .dot-demo .dot.on {
    background: var(--dot-on);
    border-color: var(--dot-on);
    box-shadow: 0 0 6px var(--dot-glow);
  }

  .docs .dot-demo span {
    color: var(--ui-dim);
    font-size: 0.7rem;
    margin-left: 4px;
  }

  .docs a {
    color: var(--ui-accent2);
    text-decoration: none;
    border-bottom: 1px solid transparent;
    transition: border-color 0.2s;
  }

  .docs a:hover { border-bottom-color: var(--ui-accent2); }

  .docs hr { border: none; border-top: 1px solid var(--frame-hi); margin: 24px 0; }

  .docs .kbd {
    display: inline-block;
    background: var(--frame-hi);
    border: 1px solid var(--border);
    border-radius: 3px;
    padding: 1px 7px;
    font-size: 0.7rem;
    color: var(--ui-mid);
    vertical-align: middle;
  }

  /* ============ RESPONSIVE ============ */
  @media (max-width: 820px) {
    .cell { width: 48px; height: 48px; font-size: 1.4rem; }
    .clock-frame { padding: 28px; }
  }

  @media (max-width: 600px) {
    .cell { width: 32px; height: 32px; font-size: 1rem; }
    .grid { gap: 2px; }
    .clock-frame { padding: 18px; }
    .time-input { font-size: 1.8rem; }
    .modal { padding: 24px 20px; }
  }
</style>
</head>
<body>

<h1>Svensk Ordklocka</h1>

<div class="clock-frame">
  <div class="corner-dots">
    <div class="corner-dot" id="dot0"></div>
    <div class="corner-dot" id="dot1"></div>
    <div class="corner-dot" id="dot2"></div>
    <div class="corner-dot" id="dot3"></div>
  </div>
  <div class="grid" id="grid"></div>
</div>

<div class="controls">
  <input type="time" class="time-input" id="timeInput" value="12:00">
  <div class="time-text" id="timeText">KLOCKAN ÄR TOLV</div>
  <div class="slider-row">
    <span class="slider-label">00:00</span>
    <input type="range" id="timeSlider" min="0" max="1439" value="720">
    <span class="slider-label">23:59</span>
  </div>
  <div class="btn-row">
    <button id="btnLive">LIVE</button>
    <button id="btnReset">RENSA MANUELLA</button>
    <button id="btnPrev5">-5 MIN</button>
    <button id="btnNext5">+5 MIN</button>
    <button id="btnDocs">DOCS</button>
  </div>
  <div class="theme-row">
    <span class="theme-label">Tema</span>
    <div class="theme-swatch selected" data-t="warm" title="Warm White"></div>
    <div class="theme-swatch" data-t="arctic" title="Arctic"></div>
    <div class="theme-swatch" data-t="matrix" title="Matrix"></div>
    <div class="theme-swatch" data-t="sunset" title="Sunset"></div>
    <div class="theme-swatch" data-t="minimal" title="Minimal"></div>
    <div class="theme-swatch" data-t="rosegold" title="Rose Gold"></div>
  </div>
</div>

<!-- DOCS MODAL -->
<div class="modal-overlay" id="docsOverlay">
  <div class="modal">
    <button class="modal-close" id="docsClose">&times;</button>
    <div class="docs">

      <h2>Dokumentation</h2>

      <h3>Layout — 11 &times; 10 (110 LEDs)</h3>
      <p>
        Rutn&auml;tet &auml;r designat f&ouml;r QlockTwo-stil laserskärning.
        Varje cell motsvarar en WS2812B-LED. Versaler nedan &auml;r aktiva
        ordpositioner, gemener &auml;r utfyllnadsbokst&auml;ver.
      </p>
      <div class="grid-preview">
        <span class="hl">K L O C K A N</span> d a <span class="hl">&Auml; R</span><br>
        s <span class="hl">F E M</span> i s <span class="hl">T I O</span> n a<br>
        <span class="hl">T J U G O</span> m i e s n d<br>
        <span class="hl">K V A R T</span> b <span class="hl">&Ouml; V E R</span> g<br>
        l <span class="hl">I</span> d k <span class="hl">H A L V</span> &ouml; t p<br>
        <span class="hl">E T T</span> r <span class="hl">T V &Aring;</span> l s n d<br>
        <span class="hl">T R E</span> n <span class="hl">F Y R A</span> o s t<br>
        <span class="hl">F E M</span> b <span class="hl">S E X</span> o <span class="hl">S J U</span><br>
        <span class="hl">&Aring; T T A</span> m <span class="hl">N I O</span> d e k<br>
        <span class="hl">E L V A T O L V T I O</span>
      </div>
      <p>
        <code>FEM</code> och <code>TIO</code> f&ouml;rekommer tv&aring; g&aring;nger &mdash;
        en g&aring;ng som minutord (rad 1) och en g&aring;ng som timord (rad 7/9).
      </p>

      <hr>

      <h3>Svensk tidslogik</h3>
      <p>
        Klockan visar tid i 5-minutersintervall med prefixet
        <code>KLOCKAN &Auml;R</code>. Fr&aring;n <code>:25</code> refererar timmen
        till <em>n&auml;sta</em> timme (svenskt &rdquo;halv&rdquo;-system).
      </p>
      <table>
        <tr><th>Minut</th><th>M&ouml;nster</th><th>Exempel (kl 16:XX)</th></tr>
        <tr><td>:00</td><td>&mdash;</td><td>KLOCKAN &Auml;R FYRA</td></tr>
        <tr><td>:05</td><td>FEM &Ouml;VER</td><td>FEM &Ouml;VER FYRA</td></tr>
        <tr><td>:10</td><td>TIO &Ouml;VER</td><td>TIO &Ouml;VER FYRA</td></tr>
        <tr><td>:15</td><td>KVART &Ouml;VER</td><td>KVART &Ouml;VER FYRA</td></tr>
        <tr><td>:20</td><td>TJUGO &Ouml;VER</td><td>TJUGO &Ouml;VER FYRA</td></tr>
        <tr><td>:25</td><td>FEM I HALV</td><td>FEM I HALV FEM</td></tr>
        <tr><td>:30</td><td>HALV</td><td>HALV FEM</td></tr>
        <tr><td>:35</td><td>FEM &Ouml;VER HALV</td><td>FEM &Ouml;VER HALV FEM</td></tr>
        <tr><td>:40</td><td>TJUGO I</td><td>TJUGO I FEM</td></tr>
        <tr><td>:45</td><td>KVART I</td><td>KVART I FEM</td></tr>
        <tr><td>:50</td><td>TIO I</td><td>TIO I FEM</td></tr>
        <tr><td>:55</td><td>FEM I</td><td>FEM I FEM</td></tr>
      </table>

      <hr>

      <h3>H&ouml;rnpunkter (minutprickar)</h3>
      <p>
        Fyra prickar i klockh&ouml;rnena visar extra minuter inom ett
        5-minutersblock &mdash; precis som en riktig QlockTwo.
      </p>
      <div class="dot-demo"><div class="dot"></div><div class="dot"></div><div class="dot"></div><div class="dot"></div><span>+0 min (exakt p&aring; 5-min)</span></div>
      <div class="dot-demo"><div class="dot on"></div><div class="dot"></div><div class="dot"></div><div class="dot"></div><span>+1 min</span></div>
      <div class="dot-demo"><div class="dot on"></div><div class="dot on"></div><div class="dot"></div><div class="dot"></div><span>+2 min</span></div>
      <div class="dot-demo"><div class="dot on"></div><div class="dot on"></div><div class="dot on"></div><div class="dot"></div><span>+3 min</span></div>
      <div class="dot-demo"><div class="dot on"></div><div class="dot on"></div><div class="dot on"></div><div class="dot on"></div><span>+4 min</span></div>
      <p>Placering: uppe-v&auml;nster, uppe-h&ouml;ger, nere-h&ouml;ger, nere-v&auml;nster.</p>

      <hr>

      <h3>Kontroller</h3>
      <table>
        <tr><th>Kontroll</th><th>Funktion</th></tr>
        <tr><td>Tidsf&auml;lt</td><td>Skriv in exakt tid, t.ex. <code>16:25</code></td></tr>
        <tr><td>Slider</td><td>Dra f&ouml;r att scrubba genom hela dygnet</td></tr>
        <tr><td><span class="kbd">&larr;</span> <span class="kbd">&rarr;</span></td><td>Stega &plusmn;1 minut</td></tr>
        <tr><td><span class="kbd">L</span></td><td>Toggla live-l&auml;ge (realtidsklocka)</td></tr>
        <tr><td>LIVE</td><td>Synka med systemklockan</td></tr>
        <tr><td>&plusmn;5 MIN</td><td>Hoppa 5 minuter fram&aring;t/bak&aring;t</td></tr>
        <tr><td>RENSA</td><td>Sl&auml;ck alla manuellt t&auml;nda bokst&auml;ver</td></tr>
        <tr><td>Klick</td><td>Klicka en bokstav f&ouml;r att t&auml;nda/sl&auml;cka manuellt</td></tr>
        <tr><td>Tema</td><td>V&auml;lj bland 6 f&auml;rgteman via cirklarna</td></tr>
      </table>

      <hr>

      <h3>H&aring;rdvaruspec (fysisk bygge)</h3>
      <ul>
        <li><strong>LEDs:</strong> 110 &times; WS2812B + 4 h&ouml;rnpunkter = 114 totalt</li>
        <li><strong>MCU:</strong> ESP32 (WiFi f&ouml;r NTP-tidssynk)</li>
        <li><strong>Panel:</strong> 11&times;10 laserskuren frontplatta, ~400&times;360 mm</li>
        <li><strong>Cellstorlek:</strong> ~35&times;35 mm per bokstav</li>
        <li><strong>Diffusor:</strong> Frostat akrylglas eller pergamentpapper</li>
        <li><strong>LED-pitch:</strong> Matchar WS2812B-strip med 30 eller 60 LED/m</li>
      </ul>

      <hr>

      <h3>K&auml;llprojekt</h3>
      <p>
        Tidslogiken baseras p&aring;
        <a href="https://github.com/machosallad/tidsram" target="_blank">machosallad/tidsram</a>
        &mdash; det enda dedikerade svenska ordklockprojektet p&aring; GitHub.
        Layouten (11&times;10) &auml;r nydesignad f&ouml;r t&auml;tare paketering
        j&auml;mf&ouml;rt med tidsrams 12&times;12.
      </p>

    </div>
  </div>
</div>

<script>
// ============================================================
// GRID & WORD DEFINITIONS
// ============================================================
const GRID_LETTERS = [
  'K','L','O','C','K','A','N','D','A','Ä','R',
  'S','F','E','M','I','S','T','I','O','N','A',
  'T','J','U','G','O','M','I','E','S','N','D',
  'K','V','A','R','T','B','Ö','V','E','R','G',
  'L','I','D','K','H','A','L','V','Ö','T','P',
  'E','T','T','R','T','V','Å','L','S','N','D',
  'T','R','E','N','F','Y','R','A','O','S','T',
  'F','E','M','B','S','E','X','O','S','J','U',
  'Å','T','T','A','M','N','I','O','D','E','K',
  'E','L','V','A','T','O','L','V','T','I','O'
];

const WORDS = {
  KLOCKAN:[0,1,2,3,4,5,6], ÄR:[9,10],
  FEM_MIN:[12,13,14], TIO_MIN:[17,18,19],
  TJUGO:[22,23,24,25,26], I_WORD:[45],
  KVART:[33,34,35,36,37], ÖVER:[39,40,41,42], HALV:[48,49,50,51],
  ETT:[55,56,57], TVÅ:[59,60,61], TRE:[66,67,68],
  FYRA:[70,71,72,73], FEM_HOUR:[77,78,79],
  SEX:[81,82,83], SJU:[85,86,87], ÅTTA:[88,89,90,91],
  NIO:[93,94,95], ELVA:[99,100,101,102],
  TOLV:[103,104,105,106], TIO_HOUR:[107,108,109]
};

const HOUR_WORDS = [
  'TOLV','ETT','TVÅ','TRE','FYRA','FEM_HOUR',
  'SEX','SJU','ÅTTA','NIO','TIO_HOUR','ELVA','TOLV'
];
const HOUR_NAMES = [
  'TOLV','ETT','TVÅ','TRE','FYRA','FEM',
  'SEX','SJU','ÅTTA','NIO','TIO','ELVA','TOLV'
];

const MINUTE_PATTERNS = [
  { words: [],                              text: '' },
  { words: ['FEM_MIN','ÖVER'],              text: 'FEM ÖVER' },
  { words: ['TIO_MIN','ÖVER'],              text: 'TIO ÖVER' },
  { words: ['KVART','ÖVER'],                text: 'KVART ÖVER' },
  { words: ['TJUGO','ÖVER'],                text: 'TJUGO ÖVER' },
  { words: ['FEM_MIN','I_WORD','HALV'],     text: 'FEM I HALV' },
  { words: ['HALV'],                        text: 'HALV' },
  { words: ['FEM_MIN','ÖVER','HALV'],       text: 'FEM ÖVER HALV' },
  { words: ['TJUGO','I_WORD'],              text: 'TJUGO I' },
  { words: ['KVART','I_WORD'],              text: 'KVART I' },
  { words: ['TIO_MIN','I_WORD'],            text: 'TIO I' },
  { words: ['FEM_MIN','I_WORD'],            text: 'FEM I' },
];

// ============================================================
// STATE
// ============================================================
let manualToggles = new Set();
let liveMode = false;
let liveInterval = null;

// ============================================================
// BUILD GRID
// ============================================================
const gridEl = document.getElementById('grid');
const cells = [];

GRID_LETTERS.forEach((letter, i) => {
  const cell = document.createElement('div');
  cell.className = 'cell';
  cell.textContent = letter;
  cell.addEventListener('click', () => toggleManual(i));
  gridEl.appendChild(cell);
  cells.push(cell);
});

// ============================================================
// TIME LOGIC
// ============================================================
function getActiveIndices(hour, minute) {
  const mi = Math.floor(minute / 5);
  const hi = (hour % 12) + (minute >= 25 ? 1 : 0);
  let idx = [...WORDS.KLOCKAN, ...WORDS.ÄR];
  MINUTE_PATTERNS[mi].words.forEach(w => { idx = idx.concat(WORDS[w]); });
  return idx.concat(WORDS[HOUR_WORDS[hi]]);
}

function getTimeText(hour, minute) {
  const mi = Math.floor(minute / 5);
  const hi = (hour % 12) + (minute >= 25 ? 1 : 0);
  const p = ['KLOCKAN', 'ÄR'];
  if (MINUTE_PATTERNS[mi].text) p.push(MINUTE_PATTERNS[mi].text);
  p.push(HOUR_NAMES[hi]);
  return p.join(' ');
}

// ============================================================
// RENDER
// ============================================================
function render(hour, minute) {
  const activeSet = new Set(getActiveIndices(hour, minute));
  cells.forEach((cell, i) => {
    cell.classList.remove('active', 'manual-toggle');
    if (manualToggles.has(i)) cell.classList.add('manual-toggle');
    else if (activeSet.has(i)) cell.classList.add('active');
  });
  for (let d = 0; d < 4; d++)
    document.getElementById('dot' + d).classList.toggle('active', d < minute % 5);

  const ti = document.getElementById('timeInput');
  if (document.activeElement !== ti)
    ti.value = String(hour).padStart(2,'0') + ':' + String(minute).padStart(2,'0');
  document.getElementById('timeText').textContent = getTimeText(hour, minute);
}

// ============================================================
// SLIDER & INPUT
// ============================================================
const slider = document.getElementById('timeSlider');
const timeInput = document.getElementById('timeInput');

function getSliderTime() {
  const v = parseInt(slider.value);
  return { hour: Math.floor(v / 60), minute: v % 60 };
}

slider.addEventListener('input', () => {
  stopLive();
  const { hour, minute } = getSliderTime();
  render(hour, minute);
});

timeInput.addEventListener('change', () => {
  stopLive();
  const [h, m] = timeInput.value.split(':').map(Number);
  if (!isNaN(h) && !isNaN(m)) { slider.value = h * 60 + m; render(h, m); }
});

// ============================================================
// MANUAL TOGGLE
// ============================================================
function toggleManual(i) {
  manualToggles.has(i) ? manualToggles.delete(i) : manualToggles.add(i);
  const { hour, minute } = getSliderTime();
  render(hour, minute);
}

// ============================================================
// BUTTONS
// ============================================================
document.getElementById('btnReset').addEventListener('click', () => {
  manualToggles.clear();
  const { hour, minute } = getSliderTime();
  render(hour, minute);
});

document.getElementById('btnLive').addEventListener('click', () => {
  liveMode ? stopLive() : startLive();
});

document.getElementById('btnPrev5').addEventListener('click', () => {
  stopLive();
  slider.value = Math.max(0, parseInt(slider.value) - 5);
  const { hour, minute } = getSliderTime();
  render(hour, minute);
});

document.getElementById('btnNext5').addEventListener('click', () => {
  stopLive();
  slider.value = Math.min(1439, parseInt(slider.value) + 5);
  const { hour, minute } = getSliderTime();
  render(hour, minute);
});

function startLive() {
  liveMode = true;
  document.getElementById('btnLive').classList.add('active-btn');
  updateLive();
  liveInterval = setInterval(updateLive, 1000);
}

function stopLive() {
  liveMode = false;
  document.getElementById('btnLive').classList.remove('active-btn');
  if (liveInterval) { clearInterval(liveInterval); liveInterval = null; }
}

function updateLive() {
  const now = new Date();
  slider.value = now.getHours() * 60 + now.getMinutes();
  render(now.getHours(), now.getMinutes());
}

// ============================================================
// THEME PICKER
// ============================================================
const swatches = document.querySelectorAll('.theme-swatch');
const themeMap = { warm: '', arctic: 'arctic', matrix: 'matrix', sunset: 'sunset', minimal: 'minimal', rosegold: 'rosegold' };

swatches.forEach(sw => {
  sw.addEventListener('click', () => {
    swatches.forEach(s => s.classList.remove('selected'));
    sw.classList.add('selected');
    const t = sw.dataset.t;
    document.documentElement.setAttribute('data-theme', themeMap[t] || '');
    localStorage.setItem('wordclock-theme', t);
  });
});

// Restore saved theme
const saved = localStorage.getItem('wordclock-theme');
if (saved && themeMap[saved] !== undefined) {
  document.documentElement.setAttribute('data-theme', themeMap[saved] || '');
  swatches.forEach(s => {
    s.classList.toggle('selected', s.dataset.t === saved);
  });
}

// ============================================================
// DOCS MODAL
// ============================================================
const docsOverlay = document.getElementById('docsOverlay');

document.getElementById('btnDocs').addEventListener('click', () => docsOverlay.classList.add('open'));
document.getElementById('docsClose').addEventListener('click', () => docsOverlay.classList.remove('open'));
docsOverlay.addEventListener('click', (e) => { if (e.target === docsOverlay) docsOverlay.classList.remove('open'); });

// ============================================================
// KEYBOARD SHORTCUTS
// ============================================================
document.addEventListener('keydown', (e) => {
  if (e.key === 'Escape') { docsOverlay.classList.remove('open'); return; }
  if (document.activeElement === timeInput) return;
  if (e.key === 'ArrowRight') {
    stopLive(); slider.value = Math.min(1439, parseInt(slider.value) + 1);
    const { hour, minute } = getSliderTime(); render(hour, minute);
  } else if (e.key === 'ArrowLeft') {
    stopLive(); slider.value = Math.max(0, parseInt(slider.value) - 1);
    const { hour, minute } = getSliderTime(); render(hour, minute);
  } else if (e.key === 'l' || e.key === 'L') {
    liveMode ? stopLive() : startLive();
  }
});

// ============================================================
// INIT
// ============================================================
startLive();
</script>
</body>
</html>
